<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FQDN Security Scanner - Multi-Agent System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        .pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; }
        .status-active { background: #22c55e; box-shadow: 0 0 8px #22c55e; }
        .status-idle { background: #6b7280; }
        .status-error { background: #ef4444; box-shadow: 0 0 8px #ef4444; }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    <div id="app">
        <!-- Header -->
        <header class="bg-gray-800 border-b border-gray-700 sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">üîê</span>
                    <h1 class="text-xl font-bold">FQDN Security Scanner</h1>
                    <span class="text-xs bg-purple-600 px-2 py-1 rounded-full">Multi-Agent</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button @click="checkAuthAndSwitchTab(activeTab === 'agents' ? 'scanner' : 'agents')"
                            class="text-sm px-3 py-1.5 rounded-lg transition"
                            :class="activeTab === 'agents' ? 'bg-purple-600' : 'bg-gray-700 hover:bg-gray-600'">
                        ü§ñ [[ activeTab === 'agents' ? 'Scanner' : 'Agents' ]]
                    </button>
                    <a href="https://github.com/XY-world/fqdn-security-scanner" target="_blank" 
                       class="text-gray-400 hover:text-white transition">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto px-4 py-8">
            
            <!-- Login Modal for Agent Panel -->
            <div v-if="showLoginModal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50">
                <div class="bg-gray-800 rounded-2xl border border-gray-700 p-8 w-full max-w-md">
                    <div class="text-center mb-6">
                        <div class="inline-flex items-center justify-center w-12 h-12 bg-blue-600 rounded-xl mb-3">
                            <span class="text-2xl">üîê</span>
                        </div>
                        <h2 class="text-xl font-bold">Agent Panel Login</h2>
                        <p class="text-gray-400 text-sm mt-1">Authentication required to access agent management</p>
                    </div>
                    
                    <div v-if="loginError" class="bg-red-900/50 border border-red-700 rounded-lg px-4 py-3 mb-4 text-red-300 text-sm">
                        [[ loginError ]]
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Username</label>
                            <input type="text" v-model="loginUsername"
                                   class="w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-3 text-white 
                                          focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition"
                                   placeholder="Enter username" @keyup.enter="doLogin">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                            <input type="password" v-model="loginPassword"
                                   class="w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-3 text-white 
                                          focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition"
                                   placeholder="Enter password" @keyup.enter="doLogin">
                        </div>
                        <button @click="doLogin"
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition">
                            üîê Login
                        </button>
                        <button @click="showLoginModal = false; activeTab = 'scanner'"
                                class="w-full bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition text-sm">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Agent Orchestra Panel - Three Column Layout -->
            <div v-if="activeTab === 'agents'" class="grid gap-4 h-[calc(100vh-120px)]"
                 :class="activityCollapsed ? 'grid-cols-10' : 'grid-cols-12'">
                
                <!-- LEFT: Agent List -->
                <div class="col-span-3 bg-gray-800 rounded-xl border border-gray-700 overflow-hidden flex flex-col">
                    <div class="px-4 py-3 border-b border-gray-700">
                        <h3 class="text-sm font-semibold text-gray-300">ü§ñ Agents</h3>
                    </div>
                    <div class="flex-1 overflow-y-auto">
                        <div v-for="(agent, key) in agents" :key="key"
                             @click="selectedAgent = key"
                             class="px-4 py-3 border-b border-gray-700/50 cursor-pointer hover:bg-gray-750 transition"
                             :class="{ 'bg-blue-900/30 border-l-2 border-l-blue-500': selectedAgent === key }">
                            <div class="flex items-center space-x-3">
                                <span class="text-xl">[[ agent.icon ]]</span>
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-medium text-sm truncate">[[ agent.display_name ]]</h4>
                                    <div class="flex items-center space-x-2 text-xs text-gray-400">
                                        <span class="status-dot" :class="'status-' + agent.status"></span>
                                        <span class="capitalize">[[ agent.status ]]</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Quick Stats -->
                            <div class="mt-2 flex space-x-2 text-xs">
                                <template v-if="key === 'discovery'">
                                    <span class="bg-gray-900 px-2 py-0.5 rounded">[[ agent.stats?.discoveries || 0 ]] discoveries</span>
                                </template>
                                <template v-if="key === 'scanner'">
                                    <span class="bg-gray-900 px-2 py-0.5 rounded">[[ moduleCount ]] modules</span>
                                </template>
                                <template v-if="key === 'pr_agent'">
                                    <span class="bg-gray-900 px-2 py-0.5 rounded">[[ agent.stats?.prs_opened || 0 ]] PRs</span>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- CENTER: Agent Content -->
                <div :class="activityCollapsed ? 'col-span-7' : 'col-span-6'" 
                     class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden flex flex-col transition-all">
                    <div class="px-4 py-3 border-b border-gray-700 flex items-center justify-between">
                        <h3 class="text-sm font-semibold text-gray-300">
                            [[ agents[selectedAgent]?.icon ]] [[ agents[selectedAgent]?.display_name ]]
                        </h3>
                        <button v-if="selectedAgent === 'discovery'" @click="triggerDiscovery"
                                :disabled="discoveryRunning"
                                class="text-xs px-3 py-1 rounded transition"
                                :class="discoveryRunning ? 'bg-gray-600 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700'">
                            <span v-if="discoveryRunning" class="pulse">‚è≥ Searching...</span>
                            <span v-else>üîç Run Discovery</span>
                        </button>
                    </div>
                    <div class="flex-1 overflow-y-auto p-4">
                        
                        <!-- Discovery Agent Content -->
                        <template v-if="selectedAgent === 'discovery'">
                            <!-- Discovery Progress Bar -->
                            <div v-if="discoveryRunning" class="mb-6 bg-gray-900 rounded-lg p-4">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm text-gray-300">üîç Searching for vulnerabilities...</span>
                                    <span class="text-xs text-gray-500">[[ discoveryProgress ]]%</span>
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-2">
                                    <div class="h-2 rounded-full bg-blue-500 transition-all duration-500"
                                         :style="{ width: discoveryProgress + '%' }"></div>
                                </div>
                                <div class="text-xs text-gray-500 mt-2">
                                    Searching CVE databases, NVD, and GitHub Security Advisories...
                                </div>
                            </div>
                            
                            <!-- Coverage Stats -->
                            <div v-if="coverage && coverage.total_discoveries > 0" class="mb-6">
                                <div class="grid grid-cols-4 gap-3 mb-4">
                                    <div class="bg-gray-900 rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">[[ coverage.total_discoveries ]]</div>
                                        <div class="text-xs text-gray-400">Total</div>
                                    </div>
                                    <div class="bg-gray-900 rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold text-green-400">[[ coverage.covered_count ]]</div>
                                        <div class="text-xs text-gray-400">Covered</div>
                                    </div>
                                    <div class="bg-gray-900 rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold text-red-400">[[ coverage.uncovered_count ]]</div>
                                        <div class="text-xs text-gray-400">Uncovered</div>
                                    </div>
                                    <div class="bg-gray-900 rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold" :class="coverage.coverage_percentage >= 70 ? 'text-green-400' : 'text-yellow-400'">
                                            [[ coverage.coverage_percentage ]]%
                                        </div>
                                        <div class="text-xs text-gray-400">Coverage</div>
                                    </div>
                                </div>
                                
                                <!-- Progress Bar -->
                                <div class="mb-4">
                                    <div class="w-full bg-gray-700 rounded-full h-2">
                                        <div class="h-2 rounded-full transition-all duration-500"
                                             :class="coverage.coverage_percentage >= 70 ? 'bg-green-500' : 'bg-yellow-500'"
                                             :style="{ width: coverage.coverage_percentage + '%' }"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Need New Modules -->
                            <div v-if="coverage?.uncovered?.length > 0" class="mb-6">
                                <h4 class="text-sm font-medium text-gray-300 mb-3">‚ö†Ô∏è Need New Modules</h4>
                                <div class="space-y-3">
                                    <div v-for="(items, moduleName) in groupedUncovered" :key="moduleName"
                                         class="bg-red-900/20 border border-red-800/50 rounded-lg p-3">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-blue-400 font-medium text-sm">[[ moduleName ]]</span>
                                                <span class="text-xs bg-red-800/50 px-2 py-0.5 rounded">[[ items.length ]] issues</span>
                                            </div>
                                            <div class="flex space-x-2">
                                                <button v-if="getGroupStatus(items) === 'new'"
                                                        @click="reviewGroup(items)"
                                                        class="text-xs bg-yellow-600 hover:bg-yellow-700 px-2 py-1 rounded">
                                                    Review
                                                </button>
                                                <button v-if="getGroupStatus(items) === 'reviewing'"
                                                        @click="triggerPRAgent(items[0].id)"
                                                        class="text-xs bg-green-600 hover:bg-green-700 px-2 py-1 rounded">
                                                    üîß Implement
                                                </button>
                                                <span v-if="getGroupStatus(items) === 'implemented'" class="text-xs text-green-400">‚úì</span>
                                            </div>
                                        </div>
                                        <!-- Test Description -->
                                        <div class="text-xs text-gray-400 mb-2">
                                            <span class="text-gray-500">Test:</span> [[ getModuleTestDescription(moduleName) ]]
                                        </div>
                                        <!-- Test Criteria -->
                                        <div class="text-xs text-gray-500">
                                            <span class="text-gray-600">Criteria:</span> [[ getModuleTestCriteria(moduleName) ]]
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Recent Discoveries -->
                            <div>
                                <h4 class="text-sm font-medium text-gray-300 mb-3">üì¢ Recent Discoveries</h4>
                                <div v-if="discoveries.length === 0" class="text-center text-gray-500 py-8">
                                    No discoveries yet. Click "Run Discovery" to search for vulnerabilities.
                                </div>
                                <div v-else class="space-y-2">
                                    <div v-for="d in discoveries.slice(0, 10)" :key="d.id"
                                         class="bg-gray-900 rounded px-3 py-2">
                                        <div class="flex items-center space-x-2 mb-1">
                                            <span class="text-xs px-1.5 py-0.5 rounded" :class="categoryClass(d.category)">[[ d.category ]]</span>
                                        </div>
                                        <div class="text-sm font-medium truncate">[[ d.title ]]</div>
                                        <div class="text-xs text-gray-500">[[ formatTimeAgo(d.timestamp) ]]</div>
                                    </div>
                                </div>
                            </div>
                        </template>
                        
                        <!-- Scanner Agent Content: Module List -->
                        <template v-if="selectedAgent === 'scanner'">
                            <h4 class="text-sm font-medium text-gray-300 mb-4">üì¶ Available Modules ([[ moduleCount ]])</h4>
                            <div class="space-y-3">
                                <div v-for="(info, key) in modules" :key="key"
                                     class="bg-gray-900 rounded-lg p-4 border border-gray-700">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center space-x-3">
                                            <span class="text-xl">[[ info.icon ]]</span>
                                            <div>
                                                <h5 class="font-medium">[[ info.name ]]</h5>
                                                <span class="text-xs text-gray-500">Module: [[ key ]]</span>
                                            </div>
                                        </div>
                                        <span v-if="key.includes('_')" class="text-xs bg-green-800/50 text-green-400 px-2 py-0.5 rounded">
                                            ü§ñ Auto-generated
                                        </span>
                                        <span v-else class="text-xs bg-blue-800/50 text-blue-400 px-2 py-0.5 rounded">
                                            üì¶ Built-in
                                        </span>
                                    </div>
                                    <p class="text-sm text-gray-400">[[ getModuleDescription(key) ]]</p>
                                </div>
                            </div>
                            
                            <div v-if="moduleCount === 0" class="text-center text-gray-500 py-8">
                                No modules available. Use Discovery Agent to find vulnerabilities, then implement modules.
                            </div>
                        </template>
                        
                        <!-- PR Agent Content -->
                        <template v-if="selectedAgent === 'pr_agent'">
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div class="bg-gray-900 rounded-lg p-4 text-center">
                                    <div class="text-2xl font-bold text-blue-400">[[ agents.pr_agent?.stats?.prs_opened || 0 ]]</div>
                                    <div class="text-xs text-gray-400">Modules Created</div>
                                </div>
                                <div class="bg-gray-900 rounded-lg p-4 text-center">
                                    <div class="text-2xl font-bold text-green-400">[[ agents.pr_agent?.stats?.prs_merged || 0 ]]</div>
                                    <div class="text-xs text-gray-400">PRs Merged</div>
                                </div>
                            </div>
                            
                            <h4 class="text-sm font-medium text-gray-300 mb-3">üîß Recent Implementations</h4>
                            <div v-if="!implementedDiscoveries.length" class="text-center text-gray-500 py-8">
                                No modules implemented yet. Review discoveries and click "Implement" to generate modules.
                            </div>
                            <div v-else class="space-y-2">
                                <div v-for="d in implementedDiscoveries" :key="d.id"
                                     class="bg-green-900/20 border border-green-800/50 rounded px-3 py-2">
                                    <div class="text-sm font-medium truncate">[[ d.title ]]</div>
                                    <div class="text-xs text-green-400">‚úì Implemented</div>
                                </div>
                            </div>
                        </template>
                        
                    </div>
                </div>
                
                <!-- RIGHT: Activity Stream (Collapsible) -->
                <div v-if="!activityCollapsed" class="col-span-3 bg-gray-800 rounded-xl border border-gray-700 overflow-hidden flex flex-col">
                    <div class="px-4 py-3 border-b border-gray-700 flex items-center justify-between">
                        <h3 class="text-sm font-semibold text-gray-300">üîÑ Activity</h3>
                        <button @click="activityCollapsed = true" class="text-gray-400 hover:text-white text-xs">
                            ‚ñ∂ Hide
                        </button>
                    </div>
                    <div class="flex-1 overflow-y-auto">
                        <div v-if="activities.length === 0" class="px-4 py-8 text-center text-gray-500 text-sm">
                            No recent activity.
                        </div>
                        <div v-else>
                            <div v-for="(activity, idx) in activities" :key="idx"
                                 class="px-4 py-2 text-xs border-b border-gray-700/50 hover:bg-gray-750">
                                <div class="flex items-center space-x-2 mb-1">
                                    <span>[[ getAgentIcon(activity.agent) ]]</span>
                                    <span class="text-gray-500">[[ formatTime(activity.timestamp) ]]</span>
                                </div>
                                <div class="text-gray-300">[[ activity.message ]]</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Collapsed Activity Toggle Button -->
                <div v-else class="flex items-start">
                    <button @click="activityCollapsed = false" 
                            class="bg-gray-800 border border-gray-700 rounded-xl px-2 py-4 text-gray-400 hover:text-white hover:bg-gray-700 transition"
                            title="Show Activity">
                        <span class="text-lg">‚óÄ</span>
                        <div class="text-xs mt-2 writing-mode-vertical">üîÑ</div>
                        <div v-if="activities.length > 0" class="mt-2 bg-blue-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                            [[ activities.length > 9 ? '9+' : activities.length ]]
                        </div>
                    </button>
                </div>
                
            </div>
            
            <!-- Scanner Tab -->
            <div v-else class="space-y-6">
                <!-- Scan Form -->
                <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-400 mb-2">Target Domain</label>
                            <input v-model="target" type="text" 
                                   placeholder="example.com or https://example.com"
                                   class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"
                                   @keyup.enter="startScan">
                        </div>
                        <div class="md:w-48">
                            <label class="block text-sm font-medium text-gray-400 mb-2">Timeout (sec)</label>
                            <input v-model.number="timeout" type="number" min="5" max="120"
                                   class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition">
                        </div>
                        <div class="md:w-32 flex items-end">
                            <button @click="startScan" :disabled="scanning || !target"
                                    class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center space-x-2">
                                <span v-if="scanning" class="pulse">‚è≥</span>
                                <span v-else>üîç</span>
                                <span>[[ scanning ? 'Scanning...' : 'Scan' ]]</span>
                            </button>
                        </div>
                    </div>

                    <!-- Module Selection -->
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-400 mb-2">Modules</label>
                        <div class="flex flex-wrap gap-2">
                            <button v-for="(info, key) in modules" :key="key"
                                    @click="toggleModule(key)"
                                    :class="selectedModules.includes(key) ? 'bg-blue-600 border-blue-500' : 'bg-gray-700 border-gray-600 hover:border-gray-500'"
                                    class="px-4 py-2 rounded-lg border transition flex items-center space-x-2">
                                <span>[[ info.icon ]]</span>
                                <span>[[ info.name ]]</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div v-if="scanning" class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-gray-400">Scanning [[ currentModule || '...' ]]</span>
                        <span class="text-sm text-gray-400">[[ progress ]]%</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div class="bg-blue-600 h-2 rounded-full transition-all duration-300"
                             :style="{ width: progress + '%' }"></div>
                    </div>
                </div>

                <!-- Results -->
                <div v-if="results" class="space-y-6">
                    <!-- Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                            <div class="text-sm text-gray-400 mb-1">Risk Score</div>
                            <div class="text-4xl font-bold" :class="riskColor">[[ results.risk_score ]]/100</div>
                            <div class="text-sm mt-1" :class="riskColor">[[ riskLevel ]]</div>
                        </div>
                        <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                            <div class="text-sm text-gray-400 mb-1">Total Findings</div>
                            <div class="text-4xl font-bold text-white">[[ results.findings.length ]]</div>
                        </div>
                        <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                            <div class="text-sm text-gray-400 mb-1">Critical + High</div>
                            <div class="text-4xl font-bold text-red-500">
                                [[ (results.severity_summary.critical || 0) + (results.severity_summary.high || 0) ]]
                            </div>
                        </div>
                        <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                            <div class="text-sm text-gray-400 mb-1">Target</div>
                            <div class="text-xl font-bold text-white truncate">[[ results.target ]]</div>
                            <div class="text-xs text-gray-500 mt-1">[[ formatTime(results.scan_time) ]]</div>
                        </div>
                    </div>

                    <!-- Severity Breakdown -->
                    <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                        <h3 class="text-lg font-semibold mb-4">Severity Breakdown</h3>
                        <div class="flex flex-wrap gap-4">
                            <div v-for="(count, severity) in results.severity_summary" :key="severity"
                                 class="flex items-center space-x-2 px-4 py-2 rounded-lg"
                                 :class="severityBgClass(severity)">
                                <span>[[ severityIcon(severity) ]]</span>
                                <span class="font-medium capitalize">[[ severity ]]</span>
                                <span class="font-bold">[[ count ]]</span>
                            </div>
                        </div>
                    </div>

                    <!-- Findings List -->
                    <div class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-700 flex items-center justify-between">
                            <h3 class="text-lg font-semibold">Findings</h3>
                            <div class="flex space-x-2">
                                <button @click="downloadReport('json')" class="text-sm px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded transition">JSON</button>
                                <button @click="downloadReport('md')" class="text-sm px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded transition">Markdown</button>
                                <button @click="downloadReport('html')" class="text-sm px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded transition">HTML</button>
                            </div>
                        </div>
                        <div v-if="results.findings.length === 0" class="px-6 py-12 text-center text-gray-500">
                            ‚úÖ No security issues found!
                        </div>
                        <div v-else class="divide-y divide-gray-700">
                            <div v-for="(finding, index) in sortedFindings" :key="index"
                                 class="px-6 py-4 hover:bg-gray-750 transition cursor-pointer"
                                 @click="toggleFinding(index)">
                                <div class="flex items-start space-x-4">
                                    <span class="text-xl">[[ severityIcon(finding.severity) ]]</span>
                                    <div class="flex-1 min-w-0">
                                        <div class="flex items-center space-x-2 mb-1">
                                            <span class="text-xs px-2 py-0.5 rounded uppercase font-medium"
                                                  :class="severityBgClass(finding.severity)">
                                                [[ finding.severity ]]
                                            </span>
                                            <span class="text-xs text-gray-500">[[ finding.module ]]</span>
                                        </div>
                                        <h4 class="font-medium">[[ finding.title ]]</h4>
                                        <p class="text-sm text-gray-400 mt-1">[[ finding.description ]]</p>
                                        <div v-if="expandedFindings.includes(index)" class="mt-3 space-y-2">
                                            <div v-if="finding.remediation" class="bg-green-900/30 border border-green-800 rounded-lg p-3">
                                                <div class="text-xs text-green-400 font-medium mb-1">Remediation</div>
                                                <p class="text-sm text-green-300">[[ finding.remediation ]]</p>
                                            </div>
                                        </div>
                                    </div>
                                    <span class="text-gray-500">[[ expandedFindings.includes(index) ? '‚ñº' : '‚ñ∂' ]]</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="border-t border-gray-800 mt-12 py-6 text-center text-gray-500 text-sm">
            FQDN Security Scanner v1.1.0 ‚Ä¢ Multi-Agent System ‚Ä¢ Built with üîê by XY-world
        </footer>
    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;
        
        createApp({
            delimiters: ['[[', ']]'],
            setup() {
                const activeTab = ref('scanner');
                const target = ref('');
                const timeout = ref(30);
                const modules = ref({{ modules | tojson }});
                const selectedModules = ref(Object.keys({{ modules | tojson }}));
                const scanning = ref(false);
                const scanId = ref(null);
                const progress = ref(0);
                const currentModule = ref('');
                const results = ref(null);
                const expandedFindings = ref([]);
                
                // Agent state
                const agents = ref({{ agents | tojson }});
                const activities = ref([]);
                const discoveries = ref([]);
                const coverage = ref(null);
                const selectedModuleFilter = ref(null);
                const selectedAgent = ref('discovery');  // Default selected agent
                const activityCollapsed = ref(false);  // Activity panel collapsed state
                
                // Authentication state
                const isAuthenticated = ref(false);
                const showLoginModal = ref(false);
                const loginUsername = ref('');
                const loginPassword = ref('');
                const loginError = ref('');
                const discoveryRunning = ref(false);  // Discovery in progress
                const discoveryProgress = ref(0);  // Discovery progress 0-100
                const implementProgress = ref({});  // Module implementation progress
                
                // Computed: filtered discoveries by selected module
                const filteredDiscoveries = computed(() => {
                    if (!selectedModuleFilter.value) return discoveries.value;
                    return discoveries.value.filter(d => {
                        const uncovered = coverage.value?.uncovered || [];
                        const matchedItem = uncovered.find(u => u.id === d.id);
                        return matchedItem && matchedItem.suggested_module === selectedModuleFilter.value;
                    });
                });
                
                // Computed: implemented discoveries for PR Agent
                const implementedDiscoveries = computed(() => {
                    return discoveries.value.filter(d => d.status === 'implemented');
                });
                
                // Module descriptions
                const moduleDescriptions = {
                    dns: "Checks DNS security configuration including DNSSEC, SPF, DKIM, DMARC, and CAA records.",
                    ssl: "Analyzes SSL/TLS configuration, certificate validity, and protocol versions.",
                    headers: "Inspects HTTP security headers like HSTS, CSP, X-Frame-Options, and more.",
                    ports: "Scans common ports to identify open services and potential vulnerabilities.",
                    subdomains: "Enumerates subdomains and checks for subdomain takeover vulnerabilities.",
                    vulns: "Detects common vulnerabilities like exposed sensitive files and version leaks."
                };
                
                const getModuleDescription = (key) => {
                    // Check static descriptions first
                    if (moduleDescriptions[key]) return moduleDescriptions[key];
                    // Dynamic modules - extract type from key
                    if (key.startsWith('ssl_')) return "SSL/TLS security scanner - checks protocol versions and certificate configuration.";
                    if (key.startsWith('headers_')) return "HTTP security headers scanner - checks for missing security headers.";
                    if (key.startsWith('email_')) return "Email security scanner - validates SPF, DKIM, and DMARC configuration.";
                    if (key.startsWith('subdomain_')) return "Subdomain security scanner - detects subdomain takeover risks.";
                    return "Security scanner module generated by PR Agent.";
                };
                
                // Test descriptions for Need New Modules - specific to module type
                const getModuleTestDescription = (moduleName) => {
                    const tests = {
                        // Security scanning modules
                        'ssl_check': 'Test SSL/TLS: certificate validity, protocol versions (TLS 1.2+), cipher strength',
                        'ssl_security': 'Test SSL/TLS: certificate chain, expiry, weak ciphers, protocol downgrade',
                        'headers_security': 'Test HTTP headers: HSTS, CSP, X-Frame-Options, X-Content-Type-Options',
                        'email_security': 'Test email auth: SPF records, DKIM signatures, DMARC policies',
                        'subdomain_takeover': 'Test subdomains: dangling CNAMEs, unclaimed cloud services',
                        'port_scan': 'Test ports: identify open ports, running services, known vulnerabilities',
                        'dns_security': 'Test DNS: DNSSEC config, CAA records, zone transfer protection',
                        
                        // Vulnerability-specific modules
                        'waf_detector': 'Test WAF: detect WAF presence, identify vendor, test bypass techniques',
                        'auth_checker': 'Test auth: JWT validation, session handling, OAuth misconfig, password reset flow',
                        'container_security': 'Test containers: image signing (cosign), registry security, runtime config',
                        'xss_scanner': 'Test XSS: reflected/stored XSS, DOM-based XSS, input sanitization',
                        'sqli_scanner': 'Test SQL injection: parameterized queries, error-based/blind SQLi',
                        'api_security': 'Test API: authentication, rate limiting, input validation, CORS config',
                        'cors_checker': 'Test CORS: allowed origins, credentials handling, preflight requests',
                        'csrf_checker': 'Test CSRF: token validation, SameSite cookie attributes',
                        'redirect_checker': 'Test redirects: open redirect vulnerabilities, URL validation',
                        'file_upload': 'Test uploads: file type validation, path traversal, executable uploads',
                        'ssrf_scanner': 'Test SSRF: internal service access, cloud metadata endpoints',
                        'crypto_checker': 'Test crypto: weak algorithms, key management, random number generation'
                    };
                    
                    // Try exact match
                    const key = moduleName.toLowerCase();
                    if (tests[key]) return tests[key];
                    
                    // Try partial match
                    for (const [k, v] of Object.entries(tests)) {
                        if (key.includes(k.split('_')[0]) || k.includes(key.split('_')[0])) return v;
                    }
                    
                    // Generic based on category keywords
                    if (key.includes('ssl') || key.includes('tls') || key.includes('cert')) 
                        return 'Test SSL/TLS: certificates, protocols, cipher configuration';
                    if (key.includes('header')) 
                        return 'Test HTTP headers: security headers presence and configuration';
                    if (key.includes('email') || key.includes('mail') || key.includes('spf') || key.includes('dkim')) 
                        return 'Test email: SPF, DKIM, DMARC records and configuration';
                    if (key.includes('dns')) 
                        return 'Test DNS: record security, DNSSEC, zone configuration';
                    if (key.includes('port') || key.includes('service')) 
                        return 'Test ports: open services, version detection, known vulnerabilities';
                    if (key.includes('auth') || key.includes('login') || key.includes('jwt') || key.includes('session')) 
                        return 'Test authentication: login flow, session management, token security';
                    if (key.includes('xss') || key.includes('injection') || key.includes('script')) 
                        return 'Test injection: XSS vulnerabilities, input sanitization';
                    if (key.includes('sql')) 
                        return 'Test SQL: injection vulnerabilities, parameterized queries';
                    if (key.includes('waf') || key.includes('firewall')) 
                        return 'Test WAF: detection, bypass techniques, rule coverage';
                    if (key.includes('container') || key.includes('docker') || key.includes('k8s')) 
                        return 'Test containers: image security, runtime config, registry access';
                    if (key.includes('api') || key.includes('rest') || key.includes('graphql')) 
                        return 'Test API: endpoint security, authentication, input validation';
                    if (key.includes('cors')) 
                        return 'Test CORS: origin whitelist, credentials handling';
                    if (key.includes('csrf')) 
                        return 'Test CSRF: token validation, cookie attributes';
                    if (key.includes('redirect') || key.includes('url')) 
                        return 'Test redirects: open redirect, URL validation';
                    if (key.includes('upload') || key.includes('file')) 
                        return 'Test uploads: file validation, path traversal protection';
                    if (key.includes('ssrf')) 
                        return 'Test SSRF: internal access, metadata endpoint protection';
                    if (key.includes('crypto') || key.includes('encrypt')) 
                        return 'Test crypto: algorithm strength, key management';
                    if (key.includes('subdomain') || key.includes('takeover')) 
                        return 'Test subdomains: dangling records, takeover vulnerabilities';
                    
                    return 'Test target for this vulnerability type using automated detection';
                };
                
                // Test criteria for Need New Modules - pass/fail conditions
                const getModuleTestCriteria = (moduleName) => {
                    const criteria = {
                        'ssl_check': 'Pass: TLS 1.2+, valid cert | Fail: Expired/weak cert',
                        'ssl_security': 'Pass: Strong config | Fail: Weak ciphers/protocols',
                        'headers_security': 'Pass: All headers set | Fail: Missing security headers',
                        'email_security': 'Pass: SPF+DKIM+DMARC valid | Fail: Missing/invalid records',
                        'subdomain_takeover': 'Pass: All CNAMEs resolve | Fail: Dangling records',
                        'port_scan': 'Pass: Expected ports only | Fail: Risky services exposed',
                        'dns_security': 'Pass: DNSSEC+CAA set | Fail: Missing protections',
                        'waf_detector': 'Pass: WAF detected | Fail: No WAF or bypassable',
                        'auth_checker': 'Pass: Secure auth flow | Fail: JWT/session flaws',
                        'container_security': 'Pass: Signed images | Fail: Unsigned/vulnerable images',
                        'xss_scanner': 'Pass: Input sanitized | Fail: XSS injectable',
                        'sqli_scanner': 'Pass: Parameterized queries | Fail: SQL injectable',
                        'api_security': 'Pass: Auth+validation OK | Fail: Exposed/vulnerable API',
                        'cors_checker': 'Pass: Strict origins | Fail: Wildcard/risky CORS',
                        'csrf_checker': 'Pass: CSRF tokens valid | Fail: Missing protection',
                        'redirect_checker': 'Pass: Validated URLs | Fail: Open redirect',
                        'file_upload': 'Pass: Strict validation | Fail: Dangerous uploads allowed',
                        'ssrf_scanner': 'Pass: Internal blocked | Fail: SSRF possible',
                        'crypto_checker': 'Pass: Strong algorithms | Fail: Weak/deprecated crypto'
                    };
                    
                    const key = moduleName.toLowerCase();
                    if (criteria[key]) return criteria[key];
                    
                    for (const [k, v] of Object.entries(criteria)) {
                        if (key.includes(k.split('_')[0]) || k.includes(key.split('_')[0])) return v;
                    }
                    
                    return 'Pass: No vulnerability | Fail: Vulnerability confirmed';
                };
                
                // Fetch agent data (with auth check)
                const fetchAgents = async () => {
                    try {
                        const res = await fetch('api/agents');
                        if (res.status === 401) {
                            isAuthenticated.value = false;
                            showLoginModal.value = true;
                            return;
                        }
                        agents.value = await res.json();
                        isAuthenticated.value = true;
                    } catch (e) { console.error('Fetch agents error:', e); }
                };
                
                const fetchActivities = async () => {
                    try {
                        const res = await fetch('api/agents/activities');
                        if (res.status === 401) return;
                        activities.value = await res.json();
                    } catch (e) { console.error('Fetch activities error:', e); }
                };
                
                const fetchDiscoveries = async () => {
                    try {
                        const res = await fetch('api/agents/discoveries');
                        if (res.status === 401) return;
                        discoveries.value = await res.json();
                    } catch (e) { console.error('Fetch discoveries error:', e); }
                };
                
                const doLogin = async () => {
                    loginError.value = '';
                    try {
                        const res = await fetch('agents/login', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                username: loginUsername.value,
                                password: loginPassword.value
                            })
                        });
                        const data = await res.json();
                        if (res.ok) {
                            isAuthenticated.value = true;
                            showLoginModal.value = false;
                            loginUsername.value = '';
                            loginPassword.value = '';
                            refreshAgentData();
                        } else {
                            loginError.value = data.error || 'Login failed';
                        }
                    } catch (e) {
                        loginError.value = 'Connection error';
                    }
                };
                
                const checkAuthAndSwitchTab = async (tab) => {
                    if (tab === 'agents' && !isAuthenticated.value) {
                        // Check if already authenticated
                        try {
                            const res = await fetch('agents/check');
                            if (res.ok) {
                                isAuthenticated.value = true;
                                activeTab.value = 'agents';
                                refreshAgentData();
                            } else {
                                showLoginModal.value = true;
                            }
                        } catch (e) {
                            showLoginModal.value = true;
                        }
                    } else {
                        activeTab.value = tab;
                        if (tab === 'agents') refreshAgentData();
                    }
                };
                
                const fetchCoverage = async () => {
                    try {
                        const res = await fetch('api/agents/coverage');
                        const data = await res.json();
                        if (data && data.total_discoveries) {
                            coverage.value = data;
                        }
                    } catch (e) { console.error('Fetch coverage error:', e); }
                };
                
                const refreshAgentData = async () => {
                    await Promise.all([fetchAgents(), fetchActivities(), fetchDiscoveries(), fetchCoverage()]);
                };
                
                onMounted(() => {
                    refreshAgentData();
                    setInterval(refreshAgentData, 5000);  // Refresh every 5 seconds
                });
                
                const triggerDiscovery = async () => {
                    try {
                        discoveryRunning.value = true;
                        discoveryProgress.value = 0;
                        const res = await fetch('api/agents/discovery/trigger', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({})
                        });
                        const data = await res.json();
                        console.log('Discovery triggered:', data);
                        // Start polling for progress
                        pollDiscoveryProgress();
                    } catch (e) { 
                        console.error('Trigger discovery error:', e);
                        discoveryRunning.value = false;
                    }
                };
                
                const pollDiscoveryProgress = () => {
                    const interval = setInterval(async () => {
                        await refreshAgentData();
                        // Check if discovery agent is still active
                        const agent = agents.value?.discovery;
                        if (agent?.status === 'active') {
                            discoveryProgress.value = Math.min(discoveryProgress.value + 10, 90);
                        } else {
                            discoveryProgress.value = 100;
                            discoveryRunning.value = false;
                            clearInterval(interval);
                        }
                    }, 2000);
                };
                
                const triggerPRAgent = async (discoveryId) => {
                    try {
                        // Set progress for this discovery
                        implementProgress.value[discoveryId] = 0;
                        
                        const res = await fetch('api/agents/pr/trigger', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ discovery_id: discoveryId })
                        });
                        const data = await res.json();
                        console.log('PR Agent triggered:', data);
                        
                        // Animate progress
                        let progress = 0;
                        const interval = setInterval(() => {
                            progress += 20;
                            implementProgress.value[discoveryId] = progress;
                            if (progress >= 100) {
                                clearInterval(interval);
                                delete implementProgress.value[discoveryId];
                                refreshAgentData();
                            }
                        }, 300);
                        
                        await updateDiscoveryStatus(discoveryId, 'implemented');
                        // Refresh modules list
                        const modulesRes = await fetch('api/modules');
                        modules.value = await modulesRes.json();
                    } catch (e) { console.error('Trigger PR agent error:', e); }
                };
                
                const updateDiscoveryStatus = async (id, status) => {
                    try {
                        await fetch(`api/agents/discoveries/${id}`, {
                            method: 'PATCH',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ status })
                        });
                        await fetchDiscoveries();
                    } catch (e) { console.error('Update discovery error:', e); }
                };
                
                const getAgentIcon = (agentName) => {
                    const icons = { discovery: 'üîç', scanner: 'üõ°Ô∏è', pr_agent: 'üîß' };
                    return icons[agentName] || 'ü§ñ';
                };
                
                const categoryClass = (category) => {
                    const classes = {
                        cve: 'bg-red-900/50 text-red-300',
                        technique: 'bg-purple-900/50 text-purple-300',
                        tool: 'bg-blue-900/50 text-blue-300',
                        research: 'bg-green-900/50 text-green-300',
                        news: 'bg-gray-700 text-gray-300'
                    };
                    return classes[category] || classes.news;
                };
                
                const statusClass = (status) => {
                    const classes = {
                        new: 'bg-yellow-900/50 text-yellow-300',
                        reviewing: 'bg-blue-900/50 text-blue-300',
                        implemented: 'bg-green-900/50 text-green-300',
                        dismissed: 'bg-gray-700 text-gray-400'
                    };
                    return classes[status] || classes.new;
                };
                
                const formatTimeAgo = (isoString) => {
                    if (!isoString) return 'Never';
                    const date = new Date(isoString);
                    const now = new Date();
                    const diffMs = now - date;
                    const diffMins = Math.floor(diffMs / 60000);
                    const diffHours = Math.floor(diffMins / 60);
                    const diffDays = Math.floor(diffHours / 24);
                    
                    if (diffMins < 1) return 'Just now';
                    if (diffMins < 60) return `${diffMins}m ago`;
                    if (diffHours < 24) return `${diffHours}h ago`;
                    return `${diffDays}d ago`;
                };
                
                // Scanner functions
                const toggleModule = (key) => {
                    const idx = selectedModules.value.indexOf(key);
                    if (idx > -1) selectedModules.value.splice(idx, 1);
                    else selectedModules.value.push(key);
                };
                
                const startScan = async () => {
                    if (!target.value || scanning.value) return;
                    scanning.value = true;
                    progress.value = 0;
                    results.value = null;
                    expandedFindings.value = [];
                    
                    try {
                        const response = await fetch('api/scan', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                target: target.value,
                                modules: selectedModules.value,
                                timeout: timeout.value
                            })
                        });
                        const data = await response.json();
                        scanId.value = data.scan_id;
                        pollStatus();
                    } catch (error) {
                        console.error('Scan error:', error);
                        scanning.value = false;
                    }
                };
                
                const pollStatus = async () => {
                    if (!scanId.value) return;
                    try {
                        const response = await fetch(`api/scan/${scanId.value}`);
                        const data = await response.json();
                        progress.value = data.progress || 0;
                        currentModule.value = data.current_module || '';
                        
                        if (data.status === 'completed') {
                            results.value = data.results;
                            scanning.value = false;
                            refreshAgentData();  // Refresh agent stats after scan
                        } else if (data.status === 'running' || data.status === 'pending') {
                            setTimeout(pollStatus, 500);
                        }
                    } catch (error) {
                        console.error('Poll error:', error);
                        scanning.value = false;
                    }
                };
                
                const toggleFinding = (index) => {
                    const idx = expandedFindings.value.indexOf(index);
                    if (idx > -1) expandedFindings.value.splice(idx, 1);
                    else expandedFindings.value.push(index);
                };
                
                const severityIcon = (severity) => {
                    const icons = { critical: 'üî¥', high: 'üü†', medium: 'üü°', low: 'üîµ', info: '‚ö™' };
                    return icons[severity?.toLowerCase()] || '‚ö™';
                };
                
                const severityBgClass = (severity) => {
                    const classes = {
                        critical: 'bg-red-900/50 text-red-300 border-red-800',
                        high: 'bg-orange-900/50 text-orange-300 border-orange-800',
                        medium: 'bg-yellow-900/50 text-yellow-300 border-yellow-800',
                        low: 'bg-blue-900/50 text-blue-300 border-blue-800',
                        info: 'bg-gray-700 text-gray-300 border-gray-600'
                    };
                    return classes[severity?.toLowerCase()] || classes.info;
                };
                
                const sortedFindings = computed(() => {
                    if (!results.value) return [];
                    const order = ['critical', 'high', 'medium', 'low', 'info'];
                    return [...results.value.findings].sort((a, b) => {
                        return order.indexOf(a.severity?.toLowerCase()) - order.indexOf(b.severity?.toLowerCase());
                    });
                });
                
                const riskColor = computed(() => {
                    if (!results.value) return 'text-white';
                    const score = results.value.risk_score;
                    if (score >= 70) return 'text-red-500';
                    if (score >= 40) return 'text-orange-500';
                    if (score >= 10) return 'text-yellow-500';
                    return 'text-green-500';
                });
                
                const riskLevel = computed(() => {
                    if (!results.value) return '';
                    const score = results.value.risk_score;
                    if (score >= 70) return 'High Risk';
                    if (score >= 40) return 'Medium Risk';
                    if (score >= 10) return 'Low Risk';
                    return 'Minimal Risk';
                });
                
                const formatTime = (isoString) => new Date(isoString).toLocaleString();
                
                // Computed: real-time module count
                const moduleCount = computed(() => Object.keys(modules.value).length);
                
                // Computed: group uncovered items by suggested module
                const groupedUncovered = computed(() => {
                    if (!coverage.value?.uncovered) return {};
                    const groups = {};
                    for (const item of coverage.value.uncovered) {
                        const mod = item.suggested_module || 'custom_check';
                        if (!groups[mod]) groups[mod] = [];
                        groups[mod].push(item);
                    }
                    return groups;
                });
                
                // Helper: get overall status for a group
                const getGroupStatus = (items) => {
                    if (items.some(i => i.status === 'implemented')) return 'implemented';
                    if (items.some(i => i.status === 'reviewing')) return 'reviewing';
                    return 'new';
                };
                
                // Review all items in a group
                const reviewGroup = async (items) => {
                    for (const item of items) {
                        if (item.status === 'new') {
                            await updateDiscoveryStatus(item.id, 'reviewing');
                        }
                    }
                    await fetchCoverage();
                };
                
                const downloadReport = (format) => {
                    if (!scanId.value) return;
                    window.open(`api/scan/${scanId.value}/report?format=${format}`, '_blank');
                };
                
                return {
                    activeTab, target, timeout, modules, selectedModules,
                    scanning, progress, currentModule, results, expandedFindings,
                    agents, activities, discoveries, coverage,
                    selectedModuleFilter, filteredDiscoveries, selectedAgent, activityCollapsed,
                    discoveryRunning, discoveryProgress, implementProgress,
                    isAuthenticated, showLoginModal, loginUsername, loginPassword, loginError,
                    doLogin, checkAuthAndSwitchTab,
                    implementedDiscoveries, getModuleDescription, getModuleTestDescription, getModuleTestCriteria,
                    moduleCount, groupedUncovered, getGroupStatus, reviewGroup,
                    toggleModule, startScan, toggleFinding,
                    severityIcon, severityBgClass, sortedFindings,
                    riskColor, riskLevel, formatTime, formatTimeAgo, downloadReport,
                    triggerDiscovery, triggerPRAgent, updateDiscoveryStatus,
                    getAgentIcon, categoryClass, statusClass
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
